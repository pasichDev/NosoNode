## Зміст

- [mpblock.pas](#mpblockpas)
- [mpCoin](#mpcoin)
- [mpdisk](#mpdisk)
- [mpGui](#mpgui)
- [mpMN](#mpmn)
- [mpparser.pas](#mpparserpas)
- [mpProtocol.pas](#mpprotocolpas)
- [mpRed](#mpred)
- [mpRPC](#mprpc)
- [mpsignerutils.pas](#mpsignerutilspas)
- [mpsyscheck.pas](#mpsyscheckpas)
- [nosoblock](#nosoblock)
- [nosoclient](#nosoclient)
- [nosoconsensus](#nosoconsensus)
- [nosocrypto](#nosocrypto)
- [nosodebug](#nosodebug)
- [nosogeneral](#nosogeneral)
- [nosogvts](#nosogvts)
- [NosoHeaders](#nosoheaders)
- [nosoipcontrol](#nosoipcontrol)
- [nosomasternode](#nosomasternode)
- [nosonetwork](#nosonetwork)
- [nosocfg](#nosocfg)
- [nosopsos](#nosopsos)
- [nosotime](#nosotime)
- [nosounit](#nosounit)
- [nosowalcon](#nosowalcon)


### mpblock.pas

```{
   // ФАЙЛ: /e:/NosoNode/mpblock.pas
   // ОПИС: Цей модуль відповідає за створення, обробку та управління блоками в системі NosoNode. 
   // Він включає функції для створення блоків, обробки транзакцій, збереження блоків на диск, 
   // розрахунку винагороди за блоки, а також управління майстернодами та PoS (Proof of Stake).

   // ОГЛЯД ІНТЕРФЕЙСУ:
   // - Procedure CrearBloqueCero(): Створює блок "Genesys" (блок 0) з початковими параметрами.
   // - Procedure BuildNewBlock(Numero, TimeStamp: Int64; TargetHash, Minero, Solucion: String): 
   //   Створює новий блок з вказаними параметрами, включаючи транзакції, винагороди та інші дані.
   // - Function GetBlockReward(BlNumber: Int64): Int64: Обчислює винагороду за блок залежно від його номера.
   // - Function GuardarBloque(...): Boolean: Зберігає блок на диск у вигляді файлу.
   // - Procedure UndoneLastBlock(): Відкочує останній блок, відновлюючи попередній стан системи.
   // - Function RemoveBlocks(UpToBlock: Int64): Integer: Видаляє блоки до вказаного номера.
   // - Function GetBlockPoSes(BlockNumber: Integer): BlockArraysPos: Повертає інформацію про PoS-адреси блоку.
   // - Function GetBlockMNs(BlockNumber: Integer): BlockArraysPos: Повертає інформацію про майстерноди блоку.
   // - Function GEtNSLBlkOrdInfo(LineText: String): String: Повертає інформацію про транзакції блоку.

   // ОГЛЯД ІМПЛЕМЕНТАЦІЇ:
   // - Функція CreateDevPaymentOrder: Створює транзакцію для виплати коштів розробникам.
   // - Функція CreateNosoPayOrder: Створює транзакцію для переказу коштів між адресами.
   // - Процедура CrearBloqueCero: Використовується для створення початкового блоку (Genesys).
   // - Процедура BuildNewBlock: Основна логіка створення нового блоку, включаючи обробку транзакцій, 
   //   розрахунок винагород, обробку PoS і майстернод.
   // - Функція GetBlockReward: Розраховує винагороду за блок залежно від кількості халвінгів.
   // - Функція GuardarBloque: Зберігає блок у файл, включаючи заголовок, транзакції, PoS і майстерноди.
   // - Процедура UndoneLastBlock: Відкочує останній блок, відновлюючи попередній стан системи.
   // - Функція RemoveBlocks: Видаляє блоки до вказаного номера.
   // - Функція GetBlockPoSes: Повертає інформацію про PoS-адреси блоку.
   // - Функція GetBlockMNs: Повертає інформацію про майстерноди блоку.
   // - Функція GEtNSLBlkOrdInfo: Повертає інформацію про транзакції блоку у форматі NSLBLKORD.

   // ОСНОВНІ КОНСТАНТИ ТА ЗМІННІ:
   // - PremineAmount: Початкова кількість монет, виділена для премайну.
   // - InitialReward: Початкова винагорода за блок.
   // - BlockHalvingInterval: Інтервал між халвінгами.
   // - HalvingSteps: Кількість халвінгів.
   // - PoSBlockStart, PoSBlockEnd: Діапазон блоків, у яких активний PoS.
   // - MNBlockStart: Номер блоку, з якого активуються майстерноди.

   // ОСОБЛИВОСТІ:
   // - Підтримка Proof of Stake (PoS) та майстернод.
   // - Автоматичне управління транзакціями та винагородами.
   // - Збереження блоків у файли для забезпечення стійкості даних.
   // - Відновлення стану системи у разі помилок або відкоту блоків.

   // ВИКОРИСТАННЯ:
   // Цей модуль є ключовим компонентом системи NosoNode і використовується для управління блокчейном, 
   // включаючи створення нових блоків, обробку транзакцій, розрахунок винагород та підтримку PoS і майстернод.
} 
```

### mpCoin

``` {
   /**
    * ### Опис модуля `mpCoin`
    * 
    * Модуль `mpCoin` реалізує функціонал для роботи з криптовалютними транзакціями, 
    * включаючи обробку балансу адрес, перевірку транзакцій, обчислення комісій, 
    * створення та управління транзакціями, а також взаємодію з блокчейном.
    * 
    * ---
    * ### Інтерфейс модуля
    * 
    * #### Функції:
    * 
    * - **`GetAddressAvailable(address: string): int64`**
    *   - Повертає доступний баланс для вказаної адреси, враховуючи вже заплановані платежі.
    * 
    * - **`GetAddressPendingPays(address: string): int64`**
    *   - Повертає суму, яка вже зарезервована для платежів з вказаної адреси.
    * 
    * - **`GetAddressIncomingPays(address: string): int64`**
    *   - Повертає суму вхідних платежів, які очікують на вказану адресу.
    * 
    * - **`VerifyIfPendingIsMine(order: TOrderData)`**
    *   - Перевіряє, чи належить транзакція користувачеві, і оновлює відповідні дані.
    * 
    * - **`AddressAlreadyCustomized(address: string): boolean`**
    *   - Перевіряє, чи вже налаштована адреса (має псевдонім або інші кастомізації).
    * 
    * - **`GVTAlreadyTransfered(NumberStr: string): boolean`**
    *   - Перевіряє, чи вже була здійснена передача GVT за вказаним номером.
    * 
    * - **`AliasAlreadyExists(Addalias: string): boolean`**
    *   - Перевіряє, чи вже існує псевдонім (alias) у системі.
    * 
    * - **`SendFundsFromAddress(Origen, Destino: string; monto, comision: int64; reference, ordertime: string; linea: integer): TOrderData`**
    *   - Створює транзакцію для відправки коштів з однієї адреси на іншу.
    * 
    * - **`CheckForMyPending()`**
    *   - Перевіряє, чи є серед очікуючих транзакцій ті, що належать користувачеві.
    * 
    * - **`GetCurrentStatus(mode: integer): string`**
    *   - Повертає поточний статус системи у вигляді текстового рядка.
    * 
    * - **`GetBlockHeaders(numberblock: integer): string`**
    *   - Повертає заголовок блоку за його номером.
    * 
    * - **`ValidRPCHost(hoststr: string): boolean`**
    *   - Перевіряє, чи є вказаний хост дозволеним для RPC-запитів.
    * 
    * - **`PendingRawInfo(ForRPC: boolean = true): string`**
    *   - Повертає інформацію про очікуючі транзакції у вигляді текстового рядка.
    * 
    * ---
    * ### Реалізація
    * 
    * #### Використовувані модулі:
    * - `Classes`, `SysUtils` — стандартні модулі для роботи з класами та системними утилітами.
    * - `MasterPaskalForm`, `mpgui`, `Clipbrd`, `strutils` — модулі для роботи з графічним інтерфейсом, буфером обміну та рядками.
    * - `nosodebug`, `nosogeneral`, `nosocrypto`, `nosounit`, `nosotime`, `nosopsos`, `nosowallcon`, `nosoblock`, `nosonetwork` — модулі для роботи з криптографією, блокчейном, мережею та іншими аспектами системи.
    * 
    * #### Основні функції:
    * - Обробка балансу адрес.
    * - Управління очікуючими транзакціями.
    * - Перевірка існування транзакцій у блоках.
    * - Генерація нових транзакцій.
    * - Взаємодія з RPC та блокчейном.
    * 
    * ---
    * ### Примітки
    * 
    * - Деякі функції закоментовані та не використовуються в поточній реалізації.
    * - Модуль використовує критичні секції (`EnterCriticalSection`, `LeaveCriticalSection`) для забезпечення потокобезпеки.
    * - Для роботи з файлами блоків використовується функція `LoadBlockDataHeader`.
    * 
    * ---
    * ### Авторство
    * 
    * Цей модуль є частиною системи NosoCoin і розроблений для роботи з криптовалютними транзакціями.
    */
}
```

### mpdisk

``` {
  // ОПИС: Цей модуль відповідає за управління файловою системою та операціями з файлами для NosoNode.
  // Він включає функції для створення структури файлів, перевірки файлів, роботи з файлами конфігурації,
  // відновлення блокчейну, управління файлами оновлень та іншими операціями, пов'язаними з файлами.

  // ІНТЕРФЕЙС:
  // - Function FileStructure(): integer;
  //   Опис: Створює необхідну структуру директорій для роботи програми.
  //   Повертає: Кількість помилок при створенні директорій.

  // - Procedure VerifyFiles();
  //   Опис: Перевіряє наявність необхідних файлів та створює їх, якщо вони відсутні.

  // - Procedure CreateADV(saving: boolean);
  //   Опис: Створює або зберігає файл розширених налаштувань (advopt.txt).
  //   Параметри:
  //     - saving: Якщо true, зберігає файл налаштувань.

  // - Procedure LoadADV();
  //   Опис: Завантажує значення з файлу розширених налаштувань (advopt.txt).

  // - Procedure UpdateWalletFromSumario();
  //   Опис: Оновлює баланс адрес гаманця на основі даних з файлу сумаріо.

  // - Procedure RebuildSummary();
  //   Опис: Повністю перебудовує файл сумаріо на основі існуючих блоків.

  // - Procedure AddBlockToSumary(BlockNumber: integer; SaveAndUpdate: boolean = true);
  //   Опис: Додає транзакції одного блоку до файлу сумаріо.
  //   Параметри:
  //     - BlockNumber: Номер блоку для додавання.
  //     - SaveAndUpdate: Якщо true, зберігає та оновлює зміни.

  // - Procedure CompleteSumary();
  //   Опис: Завершує файл сумаріо, додаючи відсутні блоки.

  // - Procedure SaveUpdatedFiles();
  //   Опис: Зберігає оновлені файли, такі як гаманець або розширені налаштування.

  // - Procedure CreateLauncherFile(IncludeUpdate: boolean = false);
  //   Опис: Створює файл запуску для перезапуску програми.
  //   Параметри:
  //     - IncludeUpdate: Якщо true, включає оновлення програми.

  // - Procedure RestartNoso();
  //   Опис: Готує програму до перезапуску, створюючи файл запуску та виконуючи його.

  // - Procedure RestoreBlockChain();
  //   Опис: Виконує необхідні кроки для відновлення блокчейну, видаляючи старі дані.

  // - Procedure RestoreSumary(fromBlock: integer = 0);
  //   Опис: Відновлює файл сумаріо, починаючи з вказаного блоку.
  //   Параметри:
  //     - fromBlock: Номер блоку, з якого почати відновлення. Якщо 0, починає з останньої позначки.

  // - Function UnZipUpdateFromRepo(Tver, TArch: String): boolean;
  //   Опис: Розпаковує файл оновлення з репозиторію.
  //   Параметри:
  //     - Tver: Версія оновлення.
  //     - TArch: Архітектура оновлення.
  //   Повертає: true, якщо розпакування успішне.

  // ІМПЛЕМЕНТАЦІЯ:
  // - Використовує модулі для роботи з файлами, діалогами, формами, криптографією, мережею та іншими функціями.
  // - Забезпечує логування подій та помилок.
  // - Підтримує багатомовність через файли .po.
  // - Реалізує функції для роботи з файлами гаманця, сумаріо, блокчейну, оновлень та іншими.

  // ЗАСТОСУВАННЯ:
  // Цей модуль є ключовим компонентом для забезпечення стабільної роботи NosoNode,
  // включаючи управління файлами, відновлення даних та підтримку оновлень.
}
```

### mpGui
```{
 * # Опис файлу
 * 
 * Цей файл є модулем `mpGUI` для графічного інтерфейсу користувача (GUI) у програмі, написаній мовою Pascal. 
 * Він містить визначення класів, процедур та функцій, які забезпечують створення, оновлення та управління 
 * графічними елементами, такими як форми, таблиці та панелі даних.
 * 
 * ## Основні компоненти
 * 
 * ### Класи
 * - **TFormInicio**: Клас для головної форми програми. Включає методи для обробки подій закриття форми.
 * - **TFormSlots**: Клас для форми моніторингу слотів. Включає методи для підготовки графічного відображення таблиці слотів.
 * 
 * ### Глобальні змінні
 * - **FormInicio**: Екземпляр класу `TFormInicio`.
 * - **GridInicio**: Таблиця для відображення текстової інформації на головній формі.
 * - **FormSlots**: Екземпляр класу `TFormSlots`.
 * - **GridMSlots**: Таблиця для моніторингу підключень та слотів.
 * - **LastUpdateMonitor**: Змінна для збереження часу останнього оновлення моніторингу.
 * - **SlotsLastUpdate**: Змінна для збереження часу останнього оновлення таблиці слотів.
 * 
 * ## Основні функції та процедури
 * 
 * ### Функції
 * - **ThisPercent(percent, thiswidth, RestarBarra)**: Обчислює відсоткове значення від заданого числа.
 * - **GetConnectedPeers()**: Повертає список IP-адрес підключених вузлів.
 * 
 * ### Процедури
 * - **CreateFormInicio()**: Створює та налаштовує головну форму програми.
 * - **CreateFormSlots()**: Створює та налаштовує форму моніторингу слотів.
 * - **UpdateSlotsGrid()**: Оновлює дані в таблиці слотів.
 * - **InitGUI()**: Ініціалізує графічний інтерфейс користувача, включаючи таблиці та панелі.
 * - **OutText(Texto, inctime, canal)**: Виводить текстову інформацію в лог, таблицю або консоль.
 * - **ActualizarGUI()**: Оновлює графічний інтерфейс користувача, включаючи моніторинг, консенсус та панелі даних.
 * - **Info(text)**: Відображає інформаційне повідомлення у спеціальній панелі.
 * - **Processhint(sender)**: Обробляє підказки для графічних елементів.
 * - **CloseAllForms()**: Закриває всі відкриті форми.
 * - **UpdateMyGVTsList()**: Оновлює список GVTs, які належать користувачу.
 * 
 * ## Використані модулі
 * - **Classes, SysUtils**: Базові модулі для роботи з класами та системними функціями.
 * - **Forms, Controls, Grids, StdCtrls**: Модулі для роботи з формами, елементами управління та таблицями.
 * - **nosotime, nosocrypto, nosoconsensus**: Спеціалізовані модулі для роботи з часом, криптографією та консенсусом.
 * - **mpParser, mpDisk, mpRed**: Модулі для обробки даних, роботи з диском та мережевими підключеннями.
 * 
 * ## Призначення
 * Цей модуль забезпечує функціональність графічного інтерфейсу користувача для програми, включаючи відображення 
 * інформації, моніторинг підключень, управління формами та оновлення даних у реальному часі.
 *}
 ```

### mpMN

```{
/**
 * ### Опис модуля `mpMN`
 * 
 * Модуль `mpMN` відповідає за управління та перевірку мастернод у системі. 
 * Він включає функціонал для роботи з перевірками мастернод, обробкою звітів, 
 * управлінням списком мастернод, а також взаємодією з мережею.
 * 
 * ---
 * 
 * ### Інтерфейс модуля
 * 
 * #### Використовувані модулі:
 * - `Classes`, `SysUtils` — стандартні модулі для роботи з класами та системними утилітами.
 * - `MasterPaskalform`, `mpcoin`, `mpgui` — модулі для роботи з графічним інтерфейсом та криптовалютами.
 * - `IdTCPClient`, `IdGlobal` — модулі для роботи з TCP-з'єднаннями.
 * - `strutils`, `nosodebug`, `nosogeneral`, `nosocrypto`, `nosotime` — утиліти для роботи з рядками, налагодженням, криптографією та часом.
 * - `nosounit`, `nosowallcon`, `nosonetwork`, `nosomasternodes` — модулі для роботи з мережею та мастернодами.
 * 
 * ---
 * 
 * ### Основні типи та класи
 * 
 * #### `TThreadMNVerificator`
 * - **Опис:** Клас потоку для перевірки мастернод.
 * - **Методи:**
 *   - `constructor Create(const CreatePaused: Boolean; const ConexSlot: Integer);`
 *     - Конструктор для створення потоку перевірки.
 *   - `procedure Execute; override;`
 *     - Основний метод виконання перевірки мастернод.
 * 
 * ---
 * 
 * ### Основні функції та процедури
 * 
 * #### Перевірка мастернод:
 * - `Function NoVerificators(): Integer;`
 *   - Повертає кількість активних перевірок.
 * - `Function RunMNVerification(): String;`
 *   - Запускає процес перевірки мастернод.
 * - `Function GetMNCheckFromString(Linea: String): TMNCheck;`
 *   - Конвертує рядок у структуру перевірки мастернод.
 * - `Function GetMNsChecksCount(): Integer;`
 *   - Повертає кількість перевірок мастернод.
 * - `Procedure ClearMNsChecks();`
 *   - Очищає всі перевірки мастернод.
 * - `Function MnsCheckExists(Ip: String): Boolean;`
 *   - Перевіряє, чи існує перевірка для заданої IP-адреси.
 * - `Procedure AddMNCheck(ThisData: TMNCheck);`
 *   - Додає нову перевірку мастернод.
 * 
 * #### Робота зі списком мастернод:
 * - `Function GetMNsListLength(): Integer;`
 *   - Повертає кількість мастернод у списку.
 * - `Procedure ClearMNsList();`
 *   - Очищає список мастернод.
 * - `Function MyMNIsListed(): Boolean;`
 *   - Перевіряє, чи є локальна мастернода у списку.
 * - `Function GetMNodeFromString(const StringData: String; out ToMNode: TMNode): Boolean;`
 *   - Конвертує рядок у структуру мастерноди.
 * - `Function IsLegitNewNode(ThisNode: TMNode): Boolean;`
 *   - Перевіряє, чи є нова мастернода легітимною.
 * - `Procedure CheckMNReport(LineText: String);`
 *   - Обробляє звіт про мастерноду.
 * - `Procedure SendMNsList(Slot: Integer);`
 *   - Відправляє список мастернод.
 * 
 * #### Робота з файлами мастернод:
 * - `Function LoadMNsFile(): String;`
 *   - Завантажує файл мастернод.
 * - `Procedure SaveMNsFile(GotText: String);`
 *   - Зберігає файл мастернод.
 * - `Procedure PTC_MNFile(Linea: String);`
 *   - Обробляє вхідний файл мастернод.
 * 
 * #### Інші функції:
 * - `Function GetMNReportString(): String;`
 *   - Генерує рядок звіту для мастерноди.
 * - `Function GetMNsAddresses(): String;`
 *   - Повертає адреси мастернод.
 * - `Function GetVerificatorsText(): String;`
 *   - Повертає текст перевіряючих вузлів.
 * 
 * ---
 * 
 * ### Глобальні змінні
 * - `ArrayIPsProcessed` — масив оброблених IP-адрес.
 * - `OpenVerificators` — кількість відкритих перевірок.
 * - `MNsList` — список мастернод.
 * - `VerifiedNodes` — список перевірених вузлів.
 * - `UnconfirmedIPs` — кількість непідтверджених IP-адрес.
 * 
 * ---
 * 
 * ### Ініціалізація та фіналізація
 * - Ініціалізація та завершення критичних секцій для забезпечення потокобезпеки.
 * 
 * ---
 * 
 * ### Примітки
 * - Модуль використовує багатопоточність для перевірки мастернод.
 * - Забезпечує потокобезпеку через використання критичних секцій.
 * - Підтримує роботу з файлами для збереження та завантаження даних мастернод.
 */
}
```

### mpparser.pas

```{// ********************************************************************************************
// ФАЙЛ: /e:/NosoNode/mpparser.pas
// ОПИС: Цей файл є частиною модуля `mpParser` і відповідає за обробку команд, пов'язаних із 
//       функціональністю гаманця, мережевими операціями, консенсусом, обробкою блоків, 
//       управлінням вузлами та іншими аспектами роботи системи NosoNode.
// ********************************************************************************************
//
// ЗАГАЛЬНА ІНФОРМАЦІЯ:
// --------------------
// Модуль `mpParser` реалізує функції для обробки команд, які надходять через консоль або інші
// джерела. Він забезпечує багатопоточну обробку даних, управління критичними секціями, 
// взаємодію з іншими модулями системи, такими як `mpGUI`, `mpDisk`, `mpRPC`, `nosocrypto` 
// та іншими. Основна мета модуля — забезпечити коректну обробку команд і виконання відповідних
// дій у системі.
//
// ОСНОВНІ ФУНКЦІЇ:
// -----------------
// 1. **Обробка команд**:
//    - `ParseCommandLine`: Аналізує текст команди, визначає її тип і викликає відповідну функцію.
//    - `ProcesarLineas`: Обробляє чергу команд у багатопоточному режимі.
//
// 2. **Управління гаманцем**:
//    - `GetWalletBalance`: Отримує баланс гаманця.
//    - `ShowWallet`: Відображає інформацію про гаманець.
//    - `ImportarWallet`, `ExportarWallet`: Імпорт/експорт гаманця.
//    - `NuevaDireccion`: Створює нову адресу гаманця.
//    - `SetDefaultAddress`: Встановлює адресу за замовчуванням.
//    - `ShowAddressInfo`, `ShowAddressHistory`: Відображає інформацію та історію адреси.
//
// 3. **Мережеві операції**:
//    - `ConnectTo`, `AutoServerON`, `AutoServerOFF`: Управління підключенням до серверів.
//    - `StartServer`, `StopServer`, `ForceServer`: Управління сервером.
//    - `ShowNodes`, `ShowBots`: Відображення інформації про вузли та ботів.
//    - `TestNetwork`: Тестування мережі.
//
// 4. **Обробка блоків**:
//    - `ShowBlchHead`, `ShowBlockInfo`: Відображення інформації про блоки.
//    - `UndoneLastBlock`: Відкат останнього блоку (для тестування).
//    - `RestoreBlockChain`: Відновлення блокчейну.
//
// 5. **Консенсус і PSO**:
//    - `ShowConsensus`, `ShowConsensusStats`: Відображення статистики консенсусу.
//    - `TestNewPSO`, `GetPSOs`, `ClearPSOs`: Тестування та управління PSO (Proof-of-Stake Operations).
//
// 6. **Інші функції**:
//    - `SendFunds`, `Parse_SendFunds`: Відправка коштів.
//    - `ShowTotalFees`: Відображення загальної суми комісій.
//    - `TestHashGeneration`, `CompareHashes`: Генерація та порівняння хешів.
//    - `RunUpdate`, `RunGetBeta`: Оновлення системи.
//    - `ShowSystemInfo`: Відображення системної інформації.
//
// КРИТИЧНІ СЕКЦІЇ:
// -----------------
// Для забезпечення багатопоточної безпеки використовуються критичні секції:
// - `CSProcessLines`: Для управління чергою команд.
// - `CSOutgoingMsjs`: Для управління чергою вихідних повідомлень.
//
// ВИКОРИСТАНІ МОДУЛІ:
// -------------------
// - `Classes`, `SysUtils`: Базові модулі для роботи з класами та системними утилітами.
// - `mpGUI`, `mpDisk`, `mpRPC`: Модулі для роботи з графічним інтерфейсом, диском та RPC.
// - `nosocrypto`, `nosogeneral`: Модулі для криптографії та загальних функцій.
// - `DateUtils`, `math`: Модулі для роботи з датами та математичними операціями.
//
// ПРИМІТКИ:
// ---------
// - Код містить функції для тестування (`TestParser`, `DebugTest2`) та налагодження.
// - Деякі функції позначені як "to be removed" і можуть бути видалені в майбутніх версіях.
// - Команди обробляються у верхньому регістрі (`UpperCase(Command)`).
//
// ********************************************************************************************
}
```

### mpProtocol.pas

``` {// ============================================================================
// Файл: mpProtocol.pas
// Опис: Модуль реалізує протокол обміну повідомленнями між вузлами мережі Noso.
// Містить функції для обробки протоколу, відправки/отримання блоків, транзакцій,
// пінгів, адміністративних повідомлень, а також роботи з файлами заголовків,
// резюме, PSO, GVT та іншими службовими структурами.
// ============================================================================

//
// Опис основних типів та процедур:
//
// - GetOrderFromString: Парсить рядок у структуру TOrderData.
// - GetStringFromBlockHeader: Формує рядок з даними заголовка блоку.
// - ParseProtocolLines: Головна процедура обробки вхідних протокольних рядків від підключень.
// - PTC_SendLine: Відправляє рядок протоколу у вказаний слот (з'єднання).
// - ProcessPing: Обробляє отриманий пінг, оновлює дані підключення, за потреби відповідає PONG.
// - GetPingString: Формує інформаційний рядок для пінгу.
// - PTC_SendResumen, PTC_SendSumary, PTC_SendPSOS, PTC_SendGVTs: Відправляють відповідні файли (заголовки, резюме, PSO, GVT) у вигляді потоку.
// - ZipHeaders, CreateZipBlockfile: Архівують файли заголовків/блоків у zip-архів.
// - PTC_SendBlocks: Відправляє zip-архів блоків у відповідь на запит.
// - INC_PTC_Custom, PTC_Custom: Обробка кастомних транзакцій.
// - ValidateTrfr: Перевіряє валідність транзакції переказу.
// - IsAddressLocked: Перевіряє, чи заблокована адреса.
// - IsOrderIDAlreadyProcessed: Перевіряє, чи вже оброблявся OrderID.
// - INC_PTC_Order, PTC_Order: Обробка масових транзакцій (ORDER).
// - INC_PTC_SendGVT, PTC_SendGVT: Обробка передачі GVT.
// - PTC_AdminMSG: Обробка адміністративних повідомлень (наприклад, оновлення, рестарт, зміна конфігурації).
// - PTC_CFGData: Оновлення конфігураційних даних вузла.
// - PTC_SendUpdateHeaders, PTC_HeadUpdate: Відправка та обробка оновлення заголовків блоків.
// - AddCriptoOp, DeleteCriptoOp: Додає/видаляє операцію у чергу криптографічних операцій.
//
// Константи:
// - OnlyHeaders, Getnodes, Nodes, Ping, Pong, ...: Коди команд протоколу.
//
// Примітки:
// - Для багатьох процедур використовується багатопотоковий доступ (критичні секції).
// - Передбачена обробка помилок та логування подій.
// - Деякі функції/процедури закоментовані як застарілі або не використовуються.
//
// Автор: (вкажіть автора, якщо потрібно)
// Версія: (вкажіть версію, якщо потрібно)
// ============================================================================
}
```

### mpRed

``` {
  ***********************************************************************
  * Модуль: mpRed
  * Опис:   Даний модуль відповідає за керування мережевими підключеннями,
  *         обробку з'єднань, синхронізацію з основною мережею, а також
  *         взаємодію з іншими вузлами мережі NosoNode.
  *
  * Основні можливості:
  *   - Пошук та резервування слотів для підключень.
  *   - Запуск, зупинка та контроль стану серверу.
  *   - Підключення до інших вузлів як клієнт.
  *   - Синхронізація блокчейну, файлів конфігурації, майстернод та інших даних.
  *   - Отримання та відправка транзакцій, перевірка статусу підключень.
  *   - Робота з файлами оновлень та визначення останньої версії програмного забезпечення.
  *
  * Основні типи та функції:
  *   - GetSlotFromIP, GetSlotFromContext — визначення слоту по IP або контексту.
  *   - SaveConection, ReserveSlot, UnReserveSlot — керування підключеннями.
  *   - StartServer, StopServer, ForceServer — керування сервером.
  *   - ConnectClient — підключення до іншого вузла.
  *   - SyncWithMainnet — синхронізація з основною мережею.
  *   - GetOrderDetails, GetOrderSources — отримання інформації про транзакції.
  *   - GetNodeStatusString, NodeServerInfo — отримання статусу вузла.
  *   - GetLastRelease, GetRepoFile, GetOS, GetLastVerZipFile — робота з оновленнями.
  *
  * Застосування:
  *   Модуль використовується у складі NosoNode для забезпечення
  *   повноцінної роботи вузла в мережі NosoCoin.
  *
  * Автор:   [Вкажіть автора, якщо потрібно]
  * Дата:    [Вкажіть дату, якщо потрібно]
  ***********************************************************************
}
```

### mpRPC

``` {// ============================================================================
// Юніт: mpRPC
// Опис: Реалізація RPC (Remote Procedure Call) для NosoNode. Забезпечує
//        обробку JSON-RPC запитів, взаємодію з блокчейном, гаманцем, 
//        майстернодами та іншими компонентами системи Noso.
// Автор: (вкажіть автора, якщо відомо)
// ============================================================================

/**
 * Процедури керування RPC:
 * - SetRPCPort(LineText: string): Встановлює порт для RPC-сервера.
 * - setRPCpassword(newpassword: string): Встановлює новий пароль для RPC.
 * - SetRPCOn(): Вмикає RPC-сервер.
 * - SetRPCOff(): Вимикає RPC-сервер.
 *
 * Основні функції парсингу та відповіді:
 * - IsValidJSON(MyJSONstring: string): Перевіряє, чи є рядок валідним JSON.
 * - GetJSONErrorString(ErrorCode: integer): Повертає текстове пояснення коду помилки.
 * - GetJSONErrorCode(ErrorCode, JSONIdNumber: integer): Формує JSON з кодом помилки.
 * - GetJSONResponse(ResultToSend: string; JSONIdNumber: integer): Формує JSON-відповідь.
 * - ParseRPCJSON(jsonreceived: string): Парсить вхідний JSON-RPC запит та повертає відповідь.
 * - ObjectFromString(MyString: string): Формує JSON-об'єкт з рядка параметрів.
 *
 * RPC-методи для взаємодії з блокчейном та гаманцем:
 * - RPC_Restart(NosoPParams: string): Перезапускає вузол.
 * - RPC_Banned(NosoPParams: string): Повертає статус "заблоковано".
 * - RPC_AddressBalance(NosoPParams: string): Повертає баланс адреси.
 * - RPC_OrderInfo(NosoPParams: string): Інформація про ордер.
 * - RPC_Blockinfo(NosoPParams: string): Інформація про блок.
 * - RPC_Mainnetinfo(NosoPParams: string): Інформація про основну мережу.
 * - RPC_PendingOrders(NosoPParams: string): Список очікуючих ордерів.
 * - RPC_LockedMNs(NosoPParams: string): Список заблокованих майстернод.
 * - RPC_GetPeers(NosoPParams: string): Список підключених пірів.
 * - RPC_BlockOrders(NosoPParams: string): Ордери в блоці.
 * - RPC_Masternodes(NosoPParams: string): Список майстернод.
 * - RPC_Blockmns(NosoPParams: string): Майстерноди в блоці.
 * - RPC_WalletBalance(NosoPParams: string): Баланс гаманця.
 * - RPC_NewAddress(NosoPParams: string): Створення нової адреси.
 * - RPC_NewAddressFull(NosoPParams: string): Створення нової адреси з ключами.
 * - RPC_ValidateAddress(NosoPParams: string): Перевірка локальної адреси.
 * - RPC_SetDefault(NosoPParams: string): Встановлення адреси за замовчуванням.
 * - RPC_GVTInfo(NosoPParams: string): Інформація про GVT.
 * - RPC_CheckCertificate(NosoPParams: string): Перевірка сертифікату.
 * - RPC_SubmitOrder(NosoPParams: string; waitresponse: boolean): Відправка ордеру.
 * - RPC_SendFunds(NosoPParams: string): Відправка коштів.
 *
 * Внутрішні допоміжні функції:
 * - parameter(...): Парсинг параметрів з рядка.
 * - ToLog(...): Логування подій та помилок.
 * - BeginPerformance/EndPerformance(...): Вимірювання продуктивності.
 *
 * Залежності:
 * - mpgui, FPJSON, jsonparser, strutils, mpCoin, mpRed, mpBlock, nosodebug,
 *   nosogeneral, nosocrypto, nosounit, nosoconsensus, nosowallcon, nosopsos,
 *   nosonetwork, nosoblock, nosogvts, nosomasternodes, MasterPaskalForm,
 *   mpparser, mpDisk, mpProtocol.
 *
 * Примітка:
 * - Для коректної роботи необхідно налаштувати залежності та зовнішні модулі.
 * - Деякі функції використовують глобальні змінні та структури, визначені в інших частинах проєкту.
 */}
 ```

 ### mpsignerutils.pas

 ``` {
  /*
    Файл: mpsignerutils.pas

    Опис:
    Даний модуль містить утиліти для роботи з електронними підписами на основі алгоритму ECDSA та різних кривих (SECP256K1, SECP384R1, SECP521R1, SECT283K1).
    Реалізовано генерацію ключових пар, підписування та перевірку підпису повідомлень, а також допоміжні функції для роботи з байтовими масивами та рядками.

    Авторські права:
    Дякуємо Xor-el за цю бібліотеку!

    Основні типи:
      - TKeyPair: структура для зберігання пари відкритого та закритого ключів у вигляді рядків.
      - TKeyType: перелік підтримуваних типів кривих.
      - TSignerUtils: клас з статичними методами для генерації ключів, підпису та перевірки підпису.

    Основні методи:
      - GenerateECKeyPair(AKeyType: TKeyType): TKeyPair
        Генерує пару ключів для заданого типу кривої.

      - SignMessage(const message: TBytes; const PrivateKey: TBytes; AKeyType: TKeyType): TBytes
        Підписує повідомлення за допомогою приватного ключа та повертає підпис.

      - VerifySignature(const signature: TBytes; const message: TBytes; const PublicKey: TBytes; AKeyType: TKeyType): Boolean
        Перевіряє підпис повідомлення за допомогою відкритого ключа.

      - ByteToString(const Value: TBytes): String
        Перетворює масив байтів у рядок.

      - StrToByte(const Value: String): TBytes
        Перетворює рядок у масив байтів.

    Залежності:
      - Base64, TypInfo, SysUtils, а також бібліотеки для роботи з криптографією (Clp*).

    Примітка:
      Для коректної роботи необхідно мати відповідні бібліотеки для роботи з криптографією та підтримку вибраних кривих.
  */
}
```

### mpsyscheck.pas

``` {
  Файл: mpsyscheck.pas
  Опис: Модуль для перевірки системних характеристик, таких як швидкість хешування, доступна пам'ять та швидкість завантаження.
  Автор: [Вкажіть автора]
  Дата створення: [Вкажіть дату]
  Ліцензія: [Вкажіть ліцензію]

  Опис модулю:
  Даний модуль містить функції для тестування продуктивності системи:
    - Sys_HashSpeed: Вимірює швидкість хешування SHA256 у багатопоточному режимі.
    - AllocateMem: Оцінює доступний обсяг оперативної пам'яті.
    - TestDownloadSpeed: Визначає швидкість завантаження даних з Інтернету.

  Опис класів та функцій:
  - TThreadHashtest: Клас потоку для тестування швидкості хешування.
      - Execute: Виконує 10 000 операцій хешування SHA256.
      - Create: Конструктор потоку.

  - Sys_HashSpeed(cores: integer = 4): int64
      Функція для вимірювання швидкості хешування SHA256 з використанням вказаної кількості ядер (потоків).
      Повертає кількість хешів за мілісекунду.

  - AllocateMem(UpToMb: integer = 1024): int64
      Функція для оцінки максимально доступної пам'яті (у мегабайтах).
      Для Windows та Unix реалізовано різні підходи.

  - TestDownloadSpeed(): int64
      Функція для тестування швидкості завантаження 1 МБ файлу з Інтернету.
      Повертає швидкість у байтах за мілісекунду.

  Змінні:
  - OpenHashThreads: Лічильник активних потоків хешування.

  Залежності:
    - Класи: TThread, TMemoryStream, TFPHttpClient
    - Модулі: Classes, SysUtils, fphttpclient, Linux (для Unix), nosodebug, nosocrypto

  Примітка:
    Для коректної роботи функцій необхідно підключити відповідні зовнішні модулі та бібліотеки.
}
```

### nosoblock

``` {
  Опис:
    Модуль NosoBlock містить всі функції та типи, пов'язані з обробкою блоків у системі Noso. 
    Забезпечує роботу з базою даних блоків, індексацію, збереження та завантаження блоків, 
    а також управління файлами блоків і архівацію.

  Основні типи:
    - TDBRecord: Структура для зберігання інформації про блок, ідентифікатор ордеру, джерело та отримувача.
    - BlockHeaderData: Структура для зберігання заголовку блоку (номер, часи, складність, хеші, нагорода тощо).
    - IntArray: Динамічний масив цілих чисел.

  Основні процедури та функції:
    - SetBlockDirectory(NewFolder: String): Встановлює директорію для зберігання блоків.
    - CreateDBFile(): Створює порожній файл бази даних блоків.
    - GetDBRecords(): Повертає кількість записів у файлі бази даних.
    - AddRecordToDBFile(block, order, source, target: integer): Додає новий запис у файл бази даних та індекс.
    - GetDBLastBlock(): Повертає номер останнього блоку у файлі бази даних.
    - UpdateBlockDatabase(): Оновлює базу даних до останнього блоку на диску.
    - InsertToIndex(LData: TDBRecord): Додає запис до індексу.
    - CreateOrderIDIndex(): Створює індекс ордерів з файлу бази даних.
    - GetBlockFromOrder(OrderID: string): Повертає номер блоку за ідентифікатором ордеру.
    - GetOrderFromDB(OrderID: String; out OrderInfo: TOrderData): Повертає дані ордеру за його ідентифікатором.
    - GetMyLastUpdatedBlock(): Повертає номер останнього завантаженого блоку.
    - GetBlockTrxs(BlockNumber: integer): Повертає масив транзакцій для вказаного блоку.
    - LoadBlockDataHeader(BlockNumber: integer): Завантажує заголовок блоку.
    - SaveStreamAsZipBlocks(Const LStream: TMemoryStream): Зберігає потік у zip-архів блоків.
    - GetBlocksAsStream(out LMs: TMemoryStream; firstblock, CurrentLastblock: integer): Створює zip-архів блоків у потік.

  Глобальні змінні:
    - BlockDirectory: Директорія для зберігання блоків.
    - BlocksZipFile: Ім'я zip-файлу для блоків.
    - DBDirectory: Директорія для бази даних.
    - DataBaseFilename: Ім'я файлу бази даних блоків.
    - DBFile: Файл для роботи з TDBRecord.
    - CSDBFile, CSDBIndex: Критичні секції для синхронізації доступу до файлів та індексу.
    - OrderIDIndex: Масив для індексації ордерів.

  Особливості:
    - Використовується багатопотокова синхронізація через критичні секції.
    - Підтримується індексація для швидкого пошуку ордерів.
    - Реалізовано збереження та читання блоків у вигляді файлів, а також архівація блоків у zip.
    - Обробка помилок ведеться через логування та відладочні повідомлення.

  Автор:
    NosoNosoCFG 1.1, 5 лютого 2024
}
```

### nosoclient

``` {// ============================================================================
// Модуль: NosoClient
// Опис:    Даний модуль оголошує юніт NosoClient для роботи з клієнтською
//          частиною мережі Noso. Містить підключення основних бібліотек для
//          роботи з TCP-клієнтом та мережевими контекстами.
// Автор:   [Вкажіть автора]
// Дата:    [Вкажіть дату створення]
// ============================================================================
//
// Підключені модулі:
//   - Classes, SysUtils: базові модулі для роботи з класами та системними утилітами.
//   - IdContext, IdGlobal, IdTCPClient: модулі бібліотеки Indy для роботи з TCP-клієнтом.
//
// Призначення:
//   Даний юніт слугує основою для реалізації клієнтської логіки взаємодії з мережею Noso.
//
// Примітка:
//   Реалізація функціоналу буде додана у секції IMPLEMENTATION.
//
// ============================================================================}
unit NosoClient;
```

### nosoconsensus

``` {
  nosoconsensus 1.0
  20 січня 2023
  Noso модуль для отримання консенсусу між вузлами мережі.
  Вимагає: nosodebug, nosotime, nosogeneral

  ОПИС:
  Даний модуль реалізує механізми збору та обробки даних від вузлів мережі для досягнення консенсусу щодо стану блокчейну.
  Основні функції:
    - Запуск та зупинка автоматичного консенсусу.
    - Запуск потоків для збору статусу вузлів.
    - Обробка та підрахунок результатів для визначення консенсусу.
    - Робота з масивом вузлів (додавання, отримання, підрахунок).
    - Отримання хешу консенсусу та випадкового вузла.
    - Критичні секції для потокобезпечної роботи з даними.

  ОСНОВНІ ТИПИ:
    - TThreadNodeStatus: Потік для отримання статусу окремого вузла.
    - TThreadAutoConsensus: Потік для автоматичного запуску консенсусу.
    - TConsensus: Масив рядків, що містить дані консенсусу.
    - TNodeConsensus: Структура для зберігання інформації про вузол.
    - TConsensusData: Структура для підрахунку кількості однакових значень.

  ОСНОВНІ ФУНКЦІЇ ТА ПРОЦЕДУРИ:
    - OpenThreadsValue: Повертає кількість відкритих потоків.
    - CalculateConsensus: Обчислює консенсус на основі даних вузлів.
    - GetConsensus: Повертає значення консенсусу за індексом.
    - GetRandonNode: Повертає випадковий вузол з масиву.
    - GetConHash: Генерує хеш консенсусу для рядка статусу вузла.
    - SetNodesArray: Ініціалізує масив вузлів з рядка.
    - GetNodesArrayIndex: Повертає вузол за індексом.
    - GetNodesArrayCount: Повертає кількість вузлів у масиві.
    - StartAutoConsensus: Запускає автоматичний консенсус.
    - StopAutoConsensus: Зупиняє автоматичний консенсус.

  КОНСТАНТИ:
    - cLastBlock, cHeaders, cMNsHash, cMNsCount, cLBHash, cLBTimeEnd, cSumHash, cGVTsHash, cCFGHash: Індекси для різних параметрів консенсусу.

  ГЛОБАЛЬНІ ЗМІННІ:
    - Consensus: Поточний масив консенсусу.
    - NConsensus: Масив назв параметрів консенсусу.
    - Css_TotalNodes, Css_ReachedNodes, Css_ValidNodes, Css_Percentage, Css_Completed, LastConsensusTime: Статистика консенсусу.

  ПОТІКИ ТА СИНХРОНІЗАЦІЯ:
    - Для роботи з масивом вузлів та потоками використовуються критичні секції (CSNodesArray, CSOpenThreads, CSConsensus).

  ВИКОРИСТАННЯ:
    - Для ініціалізації модуля викликається randomize та ініціалізуються критичні секції.
    - Для завершення роботи — звільняються критичні секції.

  ПРИЗНАЧЕННЯ:
    - Модуль використовується для отримання та обробки даних від вузлів мережі Noso з метою досягнення консенсусу щодо поточного стану блокчейну.
}
```

### nosocrypto

```{
  Опис:
    Модуль `nosocrypto` (версія 1.3, 4 грудня 2023) — це модуль для криптографічних функцій у середовищі Free Pascal.
    Використовується для хешування, підпису/перевірки повідомлень, генерації адрес, роботи з сертифікатами, 
    конвертації чисел між різними системами числення (base10, base16, base36, base58), а також для виконання 
    операцій з великими числами (BigMaths).

  Залежності:
    - cryptohashlib
    - mpsignerutils
    - HlpHashFactory
    - md5
    - ClpConverters
    - ClpBigInteger
    - SbpBase58
    - base64
    - NosoDebug
    - nosogeneral

  Основні типи:
    - DivResult: структура для результату ділення з рядковими полями "cociente" (частка) та "residuo" (залишок).

  Основні функції:
    - HashSha256String: Повертає SHA2-256 хеш від рядка.
    - HashMD160String: Повертає RIPEMD-160 хеш від рядка.
    - HashMD5String: Повертає MD5 хеш від рядка.
    - HashMD5File: Повертає MD5 хеш для файлу.
    - IsValid58: Перевіряє, чи є рядок коректним Base58.
    - GetStringSigned: Підписує рядок приватним ключем.
    - VerifySignedString: Перевіряє підпис повідомлення.
    - GetAddressFromPublicKey: Генерує адресу з публічного ключа.
    - NewGetAddressFromPublicKey: Альтернативний спосіб генерації адреси.
    - FutureGetAddressFromPublicKey: Майбутній формат адреси.
    - GenerateNewAddress: Генерує нову пару ключів та адресу.
    - IsValidHashAddress: Перевіряє коректність адреси.
    - GetTransferHash: Генерує хеш для трансферу.
    - GetOrderHash: Генерує хеш для ордеру.
    - GetCertificate: Створює сертифікат для адреси.
    - CheckCertificate: Перевіряє сертифікат та повертає адресу і мітку часу.
    - CheckHashDiff: Порівнює два MD5 хеша.
    - GetMultiSource: Сортує та перевіряє список адрес.

  Функції конвертації чисел:
    - B10ToB16, B10ToB58: Десяткова у шістнадцяткову/Base58.
    - B16ToB10, B16ToB36, B16ToB58: Шістнадцяткова у десяткову/Base36/Base58.
    - B58ToB10, B58ToB16: Base58 у десяткову/шістнадцяткову.
    - ChecksumBase58: Контрольна сума для Base58.
    - BMB58resumen, BMB58resumenNew, BMB58resumenInt: Підрахунок суми символів Base58.

  BigMaths (операції з великими числами):
    - ClearLeadingCeros: Видаляє провідні нулі.
    - BMAdicion: Додає два великі числа.
    - PonerCeros: Додає нулі до числа.
    - BMMultiplicar: Множить два великі числа.
    - BMDividir: Ділить два великі числа.
    - BMExponente: Підносить число до степеня.
    - BMHexToDec: Перетворює шістнадцяткове число у десяткове.
    - BM58ToDec: Перетворює Base58 у десяткове.
    - BMHexTo58: Перетворює шістнадцяткове у Base58.
    - BMDecTo58: Перетворює десяткове у Base58.
    - BMDecToHex: Перетворює десяткове у шістнадцяткове.

  Константи:
    - HexAlphabet: Алфавіт для шістнадцяткової системи.
    - B36Alphabet: Алфавіт для base36.
    - B58Alphabet: Алфавіт для base58.
    - AddtypeReg, AddTypeMulti: Типи адрес.

  Примітки:
    - Модуль містить як сучасні, так і сумісні з попередніми версіями функції.
    - Для криптографічних операцій використовується крива SECP256K1.
    - Деякі функції можуть кидати виключення при некоректних вхідних даних.
}
```

### nosodebug

```{
  НосоДебаг 1.3
  22 вересня 2023
  Юніт для реалізації функціоналу відлагодження у застосунках проєкту Noso.

  Опис:
  Даний модуль надає інструменти для:
    - Вимірювання продуктивності (Performance)
    - Ведення логів (Logs)
    - Керування потоками (Thread manager)
    - Керування файлами (Files manager)
    - Глибокого відлагодження (Deep debug control)

  Основні типи:
    - TPerformance: Структура для зберігання інформації про продуктивність певного тегу.
    - TLogND: Структура для зберігання інформації про лог (тег, кількість, файл).
    - TCoreManager: Структура для керування потоками (ім'я, час старту, час останньої активності).
    - TFileManager: Структура для керування файлами (тип, файл, пір, час останньої активності).

  Основні процедури та функції:
    - BeginPerformance(Tag): Почати вимірювання продуктивності для тегу.
    - EndPerformance(Tag): Завершити вимірювання продуктивності для тегу, повертає тривалість.
    - PerformanceToFile(Destination): Зберегти статистику продуктивності у файл.
    - CreateNewLog(LogName, LogFileName): Створити новий лог з опціональним збереженням у файл.
    - ToLog(LogTag, NewLine): Додати рядок у лог.
    - GetLogLine(LogTag, out LineContent): Отримати найстаріший рядок з логу.
    - AddNewOpenThread(ThName, TimeStamp): Додати новий потік у менеджер.
    - UpdateOpenThread(ThName, TimeStamp): Оновити інформацію про потік.
    - CloseOpenThread(ThName): Закрити потік.
    - GetProcessCopy(): Отримати копію масиву потоків.
    - AddFileProcess(FiType, FiFile, FiPeer, TimeStamp): Додати новий файл у менеджер.
    - CloseFileProcess(FiType, FiFile, FiPeer, TimeStamp): Закрити файл, повертає тривалість.
    - GetFileProcessCopy(): Отримати копію масиву файлів.
    - InitDeepDeb(LFileName, SysInfo): Ініціалізувати глибоке відлагодження.
    - ToDeepDeb(LLine): Додати рядок у глибокий лог.
    - GetDeepDebLine(out LineContent): Отримати рядок з глибокого логу.

  Глобальні змінні:
    - ArrPerformance: Масив структур продуктивності.
    - NosoDebug_UsePerformance: Чи використовувати вимірювання продуктивності.
    - ArrNDLogs, ArrNDCSs, ArrNDSLs: Масиви для логів, критичних секцій та списків рядків.
    - ArrProcess, CS_ThManager: Масив потоків та критична секція для них.
    - ArrFileMgr, CS_FileManager: Масив файлів та критична секція для них.
    - SLDeepDebLog, CS_DeepDeb, DeepDebFilename: Список для глибокого логу, критична секція та ім'я файлу.

  Особливості:
    - Для потокобезпечності використовуються критичні секції.
    - Логи можуть зберігатися як у пам'яті, так і на диск.
    - Підтримується глибоке відлагодження з можливістю збереження у файл.

  Автор: Nosoproject
}
```

### nosogeneral 

```{
  nosogeneral 1.2
  March 7th 2024
  Noso Unit for general functions
  Requires: Not dependencyes


///////////////////////////////////////////////////////////////////////////////
// Модуль: nosogeneral
// Опис: Загальні функції для проєкту Noso. Містить утиліти для роботи з рядками,
//        файлами, мережею, а також специфічні функції для протоколу Noso.
//
// Автор: (вкажіть автора, якщо потрібно)
// Версія: 1.2
// Дата: 7 березня 2024
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
// TStreamHelper
// Допоміжний клас для роботи з потоками (TStream).
// - SetString: Записує рядок у потік з префіксом довжини.
// - GetString: Зчитує рядок з потоку, враховуючи префікс довжини.
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
// TStringArray
// Динамічний масив рядків.
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
// TOrderData
// Структура для зберігання даних про ордер.
// Поля: Block, OrderID, OrderLines, OrderType, TimeStamp, Reference, TrxLine,
//       sender, Address, Receiver, AmmountFee, AmmountTrf, Signature, TrfrID.
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
// TMultiOrder
// Структура для зберігання даних про мульти-ордер.
// Поля: Block, TimeStamp, OrderID, OrderType, Reference, sender, PubKey,
//       Receiver, Signer, Signature, AmmountFee, AmmountTrf.
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
// TBlockOrdersArray
// Динамічний масив ордерів (TOrderData).
///////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////////
// ФУНКЦІЇ ТА ПРОЦЕДУРИ
///////////////////////////////////////////////////////////////////////////////

//
// Загальні функції:
//

// Parameter
// Повертає параметр з рядка за номером (роздільник - пробіл або заданий).
//
// GetCommand
// Повертає команду (перший параметр) з рядка.
//
// ProCommand
// Повертає п'ятий параметр з рядка (у верхньому регістрі).
//
// IsValidIP
// Перевіряє, чи є рядок коректною IPv4-адресою.
//
// GetSupply
// Повертає циркулюючу емісію на заданому блоці.
//
// Restar
// Перетворює позитивне число у негативне.
//
// HashrateToShow
// Перетворює швидкість хешування у зручний для читання формат.
//
// Int2Curr
// Перетворює ціле число у формат валюти (з крапкою).
//
// RunExternalProgram
// Запускає зовнішню програму.
//
// GetCustFee
// Повертає кастомну комісію для блоку.
//
// GetStackRequired
// Повертає необхідний стек Noso для блоку.
//
// GetMNsPercentage
// Повертає відсоток для Masternode для блоку.
//
// GetPoSPercentage
// Повертає відсоток для PoS для блоку.
//
// GetDevPercentage
// Повертає відсоток для розробників для блоку.
//
// GetMinimumFee
// Повертає мінімальну комісію для суми.
//
// GetMaximunToSend
// Повертає максимальну суму для відправки з урахуванням комісії.
//
// OSVersion
// Повертає рядок з інформацією про ОС.

//
// Мережеві функції:
//

// RequestLineToPeer
// Відправляє команду на вузол через TCP та повертає відповідь.
//
// RequestToPeer
// Відправляє команду на вузол (host:port) через TCP.
//
// SendApiRequest
// Відправляє HTTP GET-запит за вказаною URL-адресою.

//
// Робота з файлами:
//

// SaveTextToDisk
// Зберігає текст у файл.
//
// LoadTextFromDisk
// Завантажує текст з файлу.
//
// TryCopyFile
// Копіює файл з перевіркою.
//
// TryDeleteFile
// Видаляє файл з перевіркою.
//
// AppFileName
// Повертає ім'я виконуваного файлу без шляху.
//
// MixTxtFiles
// Об'єднує кілька текстових файлів у один, з можливістю видалення джерел.
//
// SendFileViaTCP
// Відправляє файл через TCP.
//
// UnzipFile
// Розпаковує ZIP-файл (з можливістю видалення архіву).
//
// CreateEmptyFile
// Створює порожній файл.

//
// Протокольні функції:
//

// GetStringFromOrder
// Перетворює структуру ордеру у рядок для передачі.

// ExtractMNsText
// Витягує текст після символу '$' з рядка.

///////////////////////////////////////////////////////////////////////////////
// Кінець документації
///////////////////////////////////////////////////////////////////////////////
nosogeneral 1.2
March 7th 2024
Noso Unit for general functions
Requires: Not dependencyes
}
```

### nosogvts

```{
  /*
  Модуль: nosogvts

  Опис:
    Модуль для роботи з GVT (Governance Token) у системі NosoNode.
    Забезпечує створення, збереження, завантаження та зміну власника GVT.
    Використовує критичні секції для потокобезпечної роботи з масивом та файлом GVT.
    Підтримує обчислення ціни GVT та підрахунок доступних токенів.

  Типи:
    TGVT - структура, що описує токен GVT (номер, власник, хеш, контрольне поле).

  Глобальні змінні:
    GVTsFilename - шлях до файлу з GVT.
    FileGVTs - файловий дескриптор для роботи з GVT.
    ArrGVTs - масив токенів GVT у пам'яті.
    CSGVTsArray, CSGVTsFile - критичні секції для синхронізації доступу.
    MyGVTsHash - хеш поточного стану файлу GVT.

  Константи:
    GVTBaseValue - базова вартість одного GVT.

  Основні функції та процедури:
    CreateGVTsFile() - створює новий файл GVT (перезаписує, якщо існує).
    GetGVTsAsStream(out LStream) - завантажує файл GVT у потік.
    SaveStreamAsGVTs(Const LStream) - зберігає потік у файл GVT.
    GetGVTsFileData() - завантажує дані з файлу у масив ArrGVTs.
    SaveGVTs() - зберігає масив ArrGVTs у файл.
    ChangeGVTOwner(Lnumber, OldOwner, NewOwner) - змінює власника GVT за номером.
    GetGVTIndex(Index) - повертає TGVT за індексом.
    GetGVTLength() - повертає кількість GVT у масиві.
    CountAvailableGVTs() - підраховує кількість доступних GVT.
    GetGVTPrice(available, ToSell) - обчислює ціну GVT залежно від кількості.

  Ініціалізація та фіналізація:
    Ініціалізує критичні секції та масив при запуску, звільняє ресурси при завершенні роботи модуля.

  Примітки:
    - Для потокобезпечності всі операції з масивом та файлом GVT виконуються у критичних секціях.
    - Для логування помилок використовується ToDeepDeb.
    - Для перевірки адреси власника використовується IsValidHashAddress.
  */
}
```

### NosoHeaders

```{
  Опис: 
    Модуль `NosoHeaders` призначений для керування файлом заголовків блоків у системі Noso. 
    Версія: 1.1
    Дата: 31 січня 2024 року

  Основні можливості:
    - Створення, читання, додавання та видалення записів у файлі заголовків.
    - Отримання хешу файлу заголовків.
    - Робота з потоками для збереження та завантаження даних.
    - Потокобезпечний доступ до файлу заголовків за допомогою критичної секції.

  Типи:
    - ResumenData: Структура для зберігання інформації про блок (номер блоку, хеш блоку, сумарний хеш).

  Глобальні змінні:
    - FileResumen: Файл, що містить записи ResumenData.
    - MyResumenHash: Поточний хеш файлу заголовків.
    - ResumenFilename: Ім'я файлу заголовків.
    - CS_HeadersFile: Критична секція для синхронізації доступу до файлу.

  Основні процедури та функції:
    - SetResumenHash: Встановлює хеш файлу заголовків.
    - GetResumenHash: Повертає поточний хеш файлу заголовків.
    - SetHeadersFileName: Встановлює шлях та ім'я файлу заголовків.
    - CreateHeadersFile: Створює новий порожній файл заголовків.
    - AddRecordToHeaders: Додає новий запис до файлу заголовків.
    - RemoveHeadersLastRecord: Видаляє останній запис з файлу заголовків.
    - GetHeadersHeigth: Повертає кількість записів у файлі заголовків.
    - GetHeadersLastBlock: Повертає номер останнього блоку у файлі заголовків.
    - GetHeadersAsMemStream: Завантажує файл заголовків у пам'яті як потік.
    - SaveStreamAsHeaders: Зберігає потік у файл заголовків.
    - LastHeadersString: Повертає рядок з інформацією про останні заголовки, починаючи з певного блоку.

  Примітки:
    - Для забезпечення цілісності даних використовується критична секція.
    - Усі операції з файлом супроводжуються обробкою виключень та веденням журналу помилок через ToDeepDeb.
}
```

### nosoipcontrol

``` {
  /*
  Модуль: NosoIPControl

  Опис:
    Модуль призначений для контролю та обліку IP-адрес, які взаємодіють із системою.
    Забезпечує потокобезпечне додавання та очищення записів про IP-адреси.

  Типи:
    IPControl - структура для зберігання IP-адреси та кількості звернень з неї.

  Глобальні змінні:
    ArrCont      - динамічний масив записів IPControl.
    CS_ArrCont   - критична секція для захисту доступу до ArrCont.
    LastIPsClear - час останнього очищення масиву IP-адрес.

  Функції та процедури:
    Function AddIPControl(ThisIP:String):integer;
      - Додає або оновлює запис про IP-адресу. Якщо адреса вже існує, збільшує лічильник звернень.
        Повертає поточну кількість звернень з цієї IP-адреси.

    Procedure ClearIPControls();
      - Очищає масив IP-адрес та оновлює час останнього очищення.

  Ініціалізація:
    - Ініціалізує масив ArrCont та критичну секцію CS_ArrCont.

  Завершення:
    - Звільняє ресурси критичної секції CS_ArrCont.
  */
}
```

### nosomasternode

``` {
  Файл: nosomasternodes.pas

  Опис:
  Даний модуль реалізує основну логіку роботи з мастернодами (masternodes) для блокчейн-проєкту Noso. 
  Він містить типи даних, процедури та функції для:
    - Зберігання та обробки списку мастернод,
    - Перевірки та валідації мастернод,
    - Роботи з файлами мастернод,
    - Організації багатопотокової перевірки вузлів,
    - Ведення обліку перевірок та віку мастернод,
    - Захисту даних за допомогою критичних секцій.

  Основні типи:
    - TMNode: структура для зберігання інформації про мастерноду (IP, порт, адреси, блоки, хеш тощо).
    - TMNCheck: структура для зберігання результату перевірки мастерноди.
    - TMNsData: структура для зберігання додаткових даних по мастерноді (IP:порт, адреса, вік).

  Основні процедури та функції:
    - SetMasternodesFilename: встановлює ім'я файлу для зберігання мастернод.
    - SetLocalIP, SetMN_Sign: встановлюють локальні параметри мастерноди.
    - GetMNReportString: формує рядок-звіт про мастерноду.
    - RunMNVerification: запускає багатопотокову перевірку мастернод.
    - GetMNsListLength, ClearMNsList: отримання та очищення списку мастернод.
    - IsLegitNewNode: перевіряє, чи є новий вузол легітимним.
    - CheckMNReport: обробляє звіт про мастерноду.
    - CreditMNVerifications: нараховує перевірки мастернодам.
    - Робота з файлами: LoadMNsFile, SaveMNsFile, SetMN_FileText, GetMN_FileText.
    - Робота з чергами очікування та отриманих мастернод.

  Особливості:
    - Для потокобезпечності використовуються критичні секції (TRTLCriticalSection).
    - Підтримується багатопотокова перевірка вузлів через TThreadMNVerificator.
    - Дані про мастерноди зберігаються у файлі та в оперативній пам'яті.
    - Передбачено механізми для унікальності IP, підрахунку віку, перевірки підписів та хешів.

  Призначення:
    Даний модуль є ядром для підтримки децентралізованої мережі мастернод у блокчейні Noso, 
    забезпечує їхню перевірку, збереження, синхронізацію та захист від дублювання чи підробки.

  Автор: (вкажіть автора)
  Ліцензія: (вкажіть ліцензію)
}
```

### nosonetwork

```{
Опис та аналіз файлу `/e:/NosoNode/nosonetwork.pas`

---

# Загальний опис

Цей файл є модулем Pascal (FreePascal/Lazarus), який реалізує мережеву логіку для ноди блокчейну Noso. Він відповідає за управління підключеннями до інших вузлів, обробку вхідних/вихідних повідомлень, синхронізацію блоків, роботу з ботами, пулом транзакцій, а також за передачу файлів (блоків, заголовків, конфігурацій тощо) між вузлами.

---

# Основні компоненти

## Типи даних

- **TThreadClientRead** — потік для читання даних від клієнта (іншої ноди).
- **TNodeData** — структура для зберігання IP та порту вузла.
- **Tconectiondata** — структура для зберігання інформації про підключення (IP, порт, статус, хеші, потік тощо).
- **TBotData** — структура для зберігання інформації про підозрілі IP (боти).
- **NodeServerEvents** — клас для обробки подій сервера (підключення, відключення, винятки).

## Глобальні змінні

- **Conexiones** — масив підключень до інших вузлів.
- **SlotLines** — масив черг вхідних повідомлень для кожного підключення.
- **CanalCliente** — масив TCP-клієнтів для outbound-з'єднань.
- **ArrayOutgoing** — масив черг вихідних повідомлень.
- **BotsList** — масив ботів (IP, які були заблоковані).
- **ArrayPoolTXs** — пул непідтверджених транзакцій.
- **ArrayMultiTXs** — пул мульти-транзакцій.
- **NodeServer** — TCP-сервер для прийому вхідних з'єднань.

## Критичні секції

Використовуються для потокобезпечної роботи з масивами та змінними (наприклад, пул транзакцій, список ботів, підключення).

---

# Основні функції та процедури

- **GetPendingCount, ClearAllPending, AddArrayPoolTXs, TranxAlreadyPending, TrxExistsInLastBlock** — робота з пулом транзакцій.
- **SendPendingsToPeer** — надсилання непідтверджених транзакцій іншому вузлу.
- **ProcessPing, ProcessIncomingLine** — обробка протокольних повідомлень ($PING, $PONG, $GETPENDING тощо).
- **SendMNsListToPeer, SendMNChecksToPeer** — надсилання списку мастернод та перевірок.
- **GetConexIndex, SetConexIndex, CloseSlot, IsSlotConnected** — управління підключеннями.
- **UpdateMyData** — оновлення локальних хешів та даних.
- **InitNodeServer** — ініціалізація TCP-сервера.
- **ClientsCount, TryMessageToClient, GetStreamFromClient, TryCloseServerConnection** — робота з клієнтами сервера.
- **TThreadClientRead.Execute** — основний цикл читання даних від клієнта у окремому потоці.
- **AddToIncoming, GetIncoming, LengthIncoming, ClearIncoming** — робота з чергою вхідних повідомлень.
- **UpdateBotData, DeleteBots, BotExists** — робота зі списком ботів.
- **FillNodeList, NodesListLen, NodesIndex** — робота зі списком відомих вузлів.
- **InitializeElements, ClearElements** — ініціалізація та очищення глобальних структур.

---

# Документація (українською)

## Основні типи

- **TThreadClientRead**  
  Потік для читання даних від клієнта. Використовується для асинхронного прийому повідомлень від інших вузлів.

- **Tconectiondata**  
  Структура, що містить всю інформацію про підключення до іншого вузла: IP, порт, статус, хеші блоків, потік, тощо.

- **TBotData**  
  Структура для зберігання IP-адрес ботів та часу останньої відмови у підключенні.

## Основні процедури та функції

- **GetPendingCount**  
  Повертає кількість непідтверджених транзакцій у пулі.

- **ClearAllPending**  
  Очищає пул непідтверджених транзакцій.

- **SendPendingsToPeer(Slot: int64)**  
  Надсилає всі непідтверджені транзакції вузлу з вказаним слотом.

- **TranxAlreadyPending(TrxHash: string): boolean**  
  Перевіряє, чи транзакція з даним хешем вже є у пулі.

- **AddArrayPoolTXs(order: TOrderData): boolean**  
  Додає нову транзакцію у пул, якщо вона ще не існує.

- **TrxExistsInLastBlock(trfrhash: String): boolean**  
  Перевіряє, чи транзакція вже є у останньому блоці.

- **ProcessPing(LineaDeTexto: string; Slot: integer; Responder: boolean)**  
  Обробляє повідомлення $PING/$PONG, оновлює дані про підключення.

- **ProcessIncomingLine(FSlot: integer; LLine: String)**  
  Обробляє вхідний рядок від вузла, викликає відповідні дії залежно від команди.

- **SendMNsListToPeer(slot: integer)**  
  Надсилає список мастернод вузлу.

- **SendMNChecksToPeer(Slot: integer)**  
  Надсилає перевірки мастернод вузлу.

- **GetConexIndex(Slot: integer): Tconectiondata**  
  Повертає структуру підключення для заданого слота.

- **SetConexIndex(Slot: integer; LData: Tconectiondata)**  
  Оновлює структуру підключення для заданого слота.

- **CloseSlot(Slot: integer)**  
  Закриває підключення та очищає дані для слота.

- **IsSlotConnected(number: integer): Boolean**  
  Перевіряє, чи слот підключений як клієнт або сервер.

- **UpdateMyData**  
  Оновлює локальні хеші та дані про останній блок.

- **InitNodeServer**  
  Ініціалізує TCP-сервер для прийому вхідних підключень.

- **ClientsCount**  
  Повертає кількість активних підключень до сервера.

- **TryMessageToClient(AContext: TIdContext; message: string): boolean**  
  Надсилає повідомлення клієнту, повертає true у разі успіху.

- **GetStreamFromClient(AContext: TIdContext; out LStream: TMemoryStream): boolean**  
  Зчитує потік даних від клієнта.

- **TryCloseServerConnection(AContext: TIdContext; closemsg: string = '')**  
  Безпечно закриває підключення до клієнта.

- **AddToIncoming(Index: integer; texto: string)**  
  Додає рядок у чергу вхідних повідомлень для слота.

- **GetIncoming(Index: integer): String**  
  Повертає перший рядок з черги вхідних повідомлень для слота.

- **UpdateBotData(IPUser: String)**  
  Оновлює інформацію про бота (IP), якщо він заблокований.

- **DeleteBots**  
  Очищає список ботів.

- **BotExists(IPUser: String): Boolean**  
  Перевіряє, чи IP є у списку ботів.

- **FillNodeList**  
  Заповнює список відомих вузлів з конфігурації.

- **InitializeElements**  
  Ініціалізує всі глобальні масиви, критичні секції та об'єкти.

- **ClearElements**  
  Очищає всі глобальні масиви, критичні секції та об'єкти.

---

# Призначення модуля

Цей модуль є ядром мережевої взаємодії ноди Noso. Він забезпечує:

- Підключення до інших вузлів та прийом вхідних підключень.
- Синхронізацію блоків, заголовків, конфігурацій, мастернод.
- Роботу з пулом транзакцій та мульти-транзакцій.
- Захист від ботів та дубльованих підключень.
- Асинхронну обробку вхідних/вихідних повідомлень через потоки.
- Потокобезпечну роботу з усіма критичними структурами.

---

# Примітки

- Весь код розбитий на регіони для зручності навігації.
- Для потокобезпечності використовуються критичні секції.
- Передбачена підтримка як клієнтських, так і серверних підключень.
- Передбачена можливість передачі файлів (блоків, заголовків, PSO, GVTs тощо) між вузлами.
- Є механізми для захисту від ботів та некоректних підключень.

---

**Цей файл є ключовим для роботи мережі NosoNode, забезпечуючи повний цикл мережевої взаємодії, синхронізації та захисту вузла.**
}
```

### nosocfg

```{*******************************************************************************
 Модуль NosoNosoCFG
 Версія: 1.1
 Дата: 23 березня 2024
 
 Опис:
 Самостійний модуль для керування файлом конфігурації nosocfg та його функціоналом.
 
 Основні компоненти:
 - Управління хешем конфігурації
 - Операції з файлами конфігурації
 - Управління даними конфігурації
 - Керування seed-нодами
 
 Глобальні змінні:
 - CFGFilename: String - ім'я файлу конфігурації (за замовчуванням 'nosocfg.psk')
 - CFGFile: TextFile - файл конфігурації
 - MyCFGHash: String - хеш поточної конфігурації
 - NosoCFGString: String - рядок конфігурації
 - LasTimeCFGRequest: Int64 - час останнього запиту конфігурації
 
 Критичні секції:
 - CS_CFGFile: для синхронізації доступу до файлу
 - CS_CFGData: для синхронізації доступу до даних
 - CS_CFGHash: для синхронізації доступу до хешу
 
 Основні функції:
 
 Управління хешем:
 - SetCFGHash(): встановлює хеш конфігурації
 - GetCFGHash(): повертає поточний хеш конфігурації
 
 Робота з файлами:
 - SetCFGFilename(Fname: String): встановлює ім'я файлу конфігурації
 - SaveCFGToFile(Content: String): зберігає конфігурацію у файл
 - GetCFGFromFile(): зчитує конфігурацію з файлу
 
 Управління даними:
 - SetCFGDataStr(Content: String): встановлює рядок конфігурації
 - GetCFGDataStr(LParam: Integer): отримує дані конфігурації
 - AddCFGData(DataToAdd: String, CFGIndex: Integer): додає дані
 - RemoveCFGData(DataToRemove: String, CFGIndex: Integer): видаляє дані
 - SetCFGData(DataToSet: String, CFGIndex: Integer): встановлює дані
 - RestoreCFGData(): відновлює конфігурацію за замовчуванням
 - ClearCFGData(Index: String): очищає вказаний індекс
 
 Інформаційні функції:
 - IsSeedNode(IP: String): перевіряє чи є IP адреса seed-нодом
 
 Структура конфігурації:
 0: Режим мережі (NORMAL)
 1: Список seed-нодів
 2: Список NTP серверів
 3: Застаріле (null)
 4: Застаріле (null)
 5: Заморожені дані
 
 Примітки:
 - Модуль використовує критичні секції для thread-safe доступу
 - При ініціалізації створюється файл конфігурації якщо він відсутній
 - Підтримується автоматичне оновлення seed-нодів з GitHub
*******************************************************************************}
```

### nosopsos

``` {
  nosopsos 1.0
  30 травня 2023 року
  Окремий модуль для обробки всіх PSO (активних і завершених) у основній мережі Noso.
  Вимоги: Nosogeneral


# Документація для модуля `nosopsos`

## Огляд
Модуль `nosopsos` відповідає за управління всіма PSO (Proposal Smart Objects) у основній мережі Noso, включаючи як активні, так і завершені PSO. Він забезпечує функціональність для доступу до файлів, управління заблокованими мастернодами, а також управління заголовками та даними PSO. Модуль використовує критичні секції для забезпечення потокобезпеки під час одночасних операцій.

---

## Типи

### `TPSOData`
Представляє структуру PSO (Proposal Smart Object).
- **Mode**: Ціле число, що вказує режим PSO.
- **Hash**: Рядок, що представляє унікальний хеш PSO.
- **Owner**: Рядок, що представляє власника PSO.
- **Expire**: Ціле число, що вказує блок завершення PSO.
- **Members**: Рядок, що містить учасників, пов'язаних із PSO.
- **Params**: Рядок, що містить додаткові параметри для PSO.

### `TMNsLock`
Представляє заблоковану мастерноду.
- **address**: Рядок[32], що містить адресу мастерноди.
- **expire**: Ціле число, що вказує номер блоку, коли блокування завершується.

### `TPSOHeader`
Представляє інформацію заголовка для PSO.
- **Block**: Ціле число, що вказує номер блоку, пов'язаного з PSO.
- **MNsLock**: Ціле число, що представляє кількість заблокованих мастернод.
- **count**: Ціле число, що представляє загальну кількість PSO.

### `TPSOsArray`
Масив `TPSOData`, що представляє кілька PSO.

---

## Константи

- **PSOsFileName**: Шлях до файлу за замовчуванням для збереження даних PSO.
- **MNsLockExpireLapse**: Ціле число, що представляє тривалість блокування для заблокованих мастернод.
- **PSOTimestamp, PSOBlock, PSOAction, PSOFee, PSODuration, PSOTarget, PSOMinSize, PSOMaxSize, PSOOverfill, PSOSource**: Рядкові константи, що представляють різні мітки параметрів PSO.

---

## Змінні

- **PSOsArray**: Масив `TPSOData`, що зберігає всі PSO.
- **MNSLockArray**: Масив `TMNsLock`, що зберігає заблоковані мастерноди.
- **PSOHeader**: `TPSOHeader`, що зберігає поточну інформацію заголовка PSO.
- **PSOFileHash**: Рядок, що зберігає хеш файлу PSO.
- **CS_PSOsArray, CS_PSOFile, CS_LockedMNs, CS_PSOHeaders**: Критичні секції для потокобезпечних операцій.

---

## Функції

### Доступ до файлів
- **`GetPSOHeadersFromFile`**: Завантажує заголовки PSO з файлу.
- **`LoadPSOFileFromDisk`**: Завантажує дані PSO з диска в пам'ять.
- **`SavePSOFileToDisk`**: Зберігає дані PSO на диск для заданого номера блоку.
- **`GetPSOsAsMemStream`**: Отримує дані PSO у вигляді потоку пам'яті.
- **`SavePSOsToFile`**: Зберігає потік пам'яті, що містить дані PSO, у файл.

### Управління заблокованими мастернодами
- **`GetLockedMNsCount`**: Повертає кількість заблокованих мастернод.
- **`GetLockedMNIndex`**: Отримує заблоковану мастерноду за індексом.
- **`AddLockedMM`**: Додає нову заблоковану мастерноду.
- **`ClearExpiredLockedMNs`**: Очищає завершені заблоковані мастерноди на основі поточного номера блоку.
- **`IsLockedMN`**: Перевіряє, чи є задана адреса заблокованою мастернодою.
- **`LockedMNsRawString`**: Повертає сирий рядок, що представляє заблоковані мастерноди.

### Управління заголовками PSO
- **`GetPSOHeaders`**: Отримує поточні заголовки PSO.
- **`SetPSOHeaders`**: Оновлює заголовки PSO новими даними.

### Управління PSO
- **`GetPSOValue`**: Отримує конкретне значення параметра з параметрів PSO.
- **`AddNewPSO`**: Додає новий PSO до масиву.
- **`GetPSOsCopy`**: Повертає копію поточного масиву PSO.

---

## Ініціалізація та завершення

- **Ініціалізація**: Ініціалізує критичні секції для потокобезпечних операцій.
- **Завершення**: Звільняє критичні секції для вивільнення ресурсів.

---
nosopsos 1.0
30 травня 2023 року
Окремий модуль для обробки всіх PSO (активних і завершених) у основній мережі Noso.
Вимоги: Nosogeneral
}
```

### nosotime

``` {
  Nosotime 1.3
  20 вересня 2023 року
  Модуль часу Noso для синхронізації часу в проєкті Noso.
  Потребує пакету indy. (Завдання: видалити цю залежність)

  Зміни:
  - Випадкове використання серверів NTP.
  - Асинхронний процес обмежено кожні 5 секунд.
  - Функції, пов’язані з часом блоку.
  - Тестування NTP.

  TThreadUpdateOffset:
  - Клас потоку, який використовується для асинхронного оновлення зсуву часу.
  - Hosts: Рядок, що містить сервери NTP для використання.
  - Execute: Перевизначає логіку виконання потоку для виклику GetTimeOffset.

  GetNetworkTimestamp:
  - Отримує UNIX-мітку часу з вказаного сервера NTP.
  - Параметри:
    - hostname: Ім'я хоста сервера NTP.
  - Повертає: UNIX-мітку часу як int64 або 0 у разі помилки.

  TimestampToDate:
  - Перетворює UNIX-мітку часу у зручний для читання рядок дати.
  - Параметри:
    - timestamp: UNIX-мітка часу для перетворення.
  - Повертає: Рядкове представлення дати.

  GetTimeOffset:
  - Обчислює зсув часу, використовуючи випадковий сервер NTP зі списку.
  - Параметри:
    - NTPServers: Рядок імен хостів серверів NTP, розділених двокрапкою.
  - Повертає: Обчислений зсув часу як int64.

  UTCTime:
  - Отримує поточну UTC UNIX-мітку часу, скориговану на зсув часу.
  - Повертає: Скориговану UNIX-мітку часу як int64.

  UTCTimeStr:
  - Отримує поточну UTC UNIX-мітку часу у вигляді рядка для сумісності.
  - Повертає: Скориговану UNIX-мітку часу як рядок.

  UpdateOffset:
  - Ініціює асинхронне оновлення зсуву часу за допомогою потоку.
  - Параметри:
    - NTPServers: Рядок імен хостів серверів NTP, розділених двокрапкою.

  TimeSinceStamp:
  - Обчислює час, що минув з моменту заданої UNIX-мітки часу.
  - Параметри:
    - Lvalue: UNIX-мітка часу, з якої обчислюється минулий час.
  - Повертає: Рядок, що представляє минулий час у секундах, хвилинах, годинах, днях, місяцях або роках.

  BlockAge:
  - Обчислює поточний вік блоку на основі UTC часу.
  - Повертає: Вік блоку як ціле число.

  NextBlockTimeStamp:
  - Обчислює очікувану UNIX-мітку часу для наступного блоку.
  - Повертає: Мітку часу як int64.

  IsBlockOpen:
  - Визначає, чи знаходиться поточний блок у періоді операції.
  - Повертає: Логічне значення, яке вказує, чи відкритий блок.

  Змінні:
  - NosoT_TimeOffset: Поточний зсув часу як int64.
  - NosoT_LastServer: Останній використаний сервер NTP як рядок.
  - NosoT_LastUpdate: Час останнього оновлення як int64.

Nosotime 1.3
20 вересня 2023 року
Модуль часу Noso для синхронізації часу в проєкті Noso.
Потребує пакету indy. (Завдання: видалити цю залежність)

Зміни:
- Випадкове використання серверів NTP.
- Асинхронний процес обмежено кожні 5 секунд.
- Функції, пов’язані з часом блоку.
- Тестування NTP.
}
```

### nosounit

``` {
  Nosounit 1.0
  8 січня 2023 року
  Модуль проекту Noso для роботи з підсумками

  Цей модуль надає функціонал для управління даними підсумків, включаючи створення, оновлення та доступ до файлів підсумків. 
  Він також включає утиліти для обробки протокольних замовлень, індексації підсумків та записів блоків. Модуль забезпечує 
  потокобезпечні операції за допомогою критичних секцій для одночасного доступу.

  Основні можливості:
  - Утиліти протоколу для створення протокольних замовлень.
  - Функції управління підсумками для створення, архівації та відновлення файлів підсумків.
  - Функції індексації для ефективного доступу до даних підсумків.
  - Функції для роботи з балансами, платежами та налаштуваннями.
  - Потокобезпечні операції за допомогою критичних секцій.

  Залежності:
  - Classes, SysUtils, Zipper
  - nosocrypto, nosodebug, nosogeneral

Nosounit 1.0
8 січня 2023 року
Модуль проекту Noso для роботи з підсумками
}
```

### nosowalcon

```{
  nosowallcon 1.1
  26 січня 2024 року
  Окремий модуль для управління файлом адрес гаманців та масивом.


# Документація

## Типи
### WalletData
Упакований запис, що представляє інформацію про гаманець:
- `Hash`: `String[40]` - Публічний хеш або адреса гаманця.
- `Custom`: `String[40]` - Індивідуальна назва для адреси гаманця, якщо вона персоналізована.
- `PublicKey`: `String[255]` - Публічний ключ, пов'язаний із гаманцем.
- `PrivateKey`: `String[255]` - Приватний ключ, пов'язаний із гаманцем.
- `Balance`: `int64` - Останній відомий баланс гаманця.
- `Pending`: `int64` - Останній відомий баланс очікуваних транзакцій гаманця.
- `Score`: `int64` - Стан або рейтинг запису гаманця.
- `LastOP`: `int64` - Unix-час останньої операції.

## Функції та процедури

### Управління гаманцем
- **`SetWalletFileName(Fname: String): Boolean`**
  Встановлює ім'я файлу гаманця. Якщо файл не існує, створює новий файл гаманця. Повертає `false`, якщо файл не існує.

- **`ClearWalletArray()`**
  Очищає масив гаманців у пам'яті.

- **`InsertToWallArr(LData: WalletData): Boolean`**
  Додає запис гаманця до масиву, якщо він ще не існує. Повертає `true`, якщо успішно.

- **`GetWallArrIndex(Index: Integer): WalletData`**
  Отримує запис гаманця з масиву за індексом. Повертає стандартний `WalletData`, якщо індекс виходить за межі.

- **`WallAddIndex(Address: String): Integer`**
  Знаходить індекс гаманця в масиві за його хешем або індивідуальною назвою. Повертає `-1`, якщо не знайдено.

- **`LenWallArr(): Integer`**
  Повертає довжину масиву гаманців.

- **`ChangeWallArrPos(PosA, PosB: Integer): Boolean`**
  Змінює місцями два записи гаманців у масиві. Повертає `true`, якщо успішно.

- **`ClearWallPendings()`**
  Скидає баланс очікуваних транзакцій для всіх гаманців у масиві до `0`.

- **`SetPendingForAddress(Index: Integer; Value: int64)`**
  Встановлює баланс очікуваних транзакцій для конкретного гаманця за індексом.

### Операції з файлами
- **`GetAddressFromFile(FileLocation: String; out WalletInfo: WalletData): Boolean`**
  Зчитує запис гаманця з файлу. Повертає `true`, якщо успішно.

- **`ImportAddressesFromBackup(BakFolder: String): Integer`**
  Імпортує записи гаманців із резервних файлів у вказаній папці. Повертає кількість успішно імпортованих записів.

- **`SaveAddresstoFile(FileName: String; LData: WalletData): Boolean`**
  Зберігає запис гаманця у вказаний файл. Повертає `true`, якщо успішно.

- **`CreateNewWallet(): Boolean`**
  Створює новий файл гаманця з новою згенерованою адресою. Очищає масив гаманців перед створенням.

- **`GetWalletAsStream(out LStream: TMemoryStream): int64`**
  Завантажує файл гаманця у потік пам'яті. Повертає розмір потоку.

- **`SaveWalletToFile(): Boolean`**
  Зберігає масив гаманців у файл гаманця. Створює резервну копію файлу перед збереженням. Повертає `true`, якщо успішно.

- **`LoadWallet(wallet: String): Boolean`**
  Завантажує записи гаманців із файлу в масив гаманців. Повертає `true`, якщо успішно.

- **`VerifyAddressOnDisk(HashAddress: String): Boolean`**
  Перевіряє, чи існує конкретна адреса гаманця у файлі гаманця. Повертає `true`, якщо знайдено.

## Змінні
- **`WalletArray: array of WalletData`**
  Масив записів гаманців у пам'яті.

- **`FileWallet: file of WalletData`**
  Файл, що використовується для зберігання записів гаманців.

- **`WalletFilename: string`**
  Стандартне ім'я файлу гаманця (`NOSODATA/wallet.pkw`).

- **`CS_WalletFile: TRTLCriticalSection`**
  Критична секція для синхронізації доступу до файлу гаманця.

- **`CS_WalletArray: TRTLCriticalSection`**
  Критична секція для синхронізації доступу до масиву гаманців.

## Ініціалізація та завершення
- **Ініціалізація**
  - Ініціалізує критичні секції для `CS_WalletArray` та `CS_WalletFile`.
  - Встановлює початкову довжину `WalletArray` на `0`.

- **Завершення**
  - Звільняє критичні секції для `CS_WalletArray` та `CS_WalletFile`.
nosowallcon 1.1
26 січня 2024 року
Окремий модуль для управління файлом адрес гаманців та масивом.
}
```
